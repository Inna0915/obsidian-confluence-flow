# Confluence Sync

ä»ç§æœ‰éƒ¨ç½²çš„ Confluence æœåŠ¡å™¨å•å‘åŒæ­¥é¡µé¢åˆ° Obsidianï¼Œæ”¯æŒæ ‘å½¢ç›®å½•ç»“æ„ã€å¢é‡åŒæ­¥å’Œé™„ä»¶ä¸‹è½½ã€‚

## åŠŸèƒ½ç‰¹æ€§

- ğŸŒ² **æ ‘å½¢ç»“æ„åŒæ­¥** - åŸºäº Confluence çš„ ancestors å…³ç³»é‡æ„å±‚çº§ç›®å½•
- âš¡ **å¢é‡åŒæ­¥** - åŸºäº `lastModified` æ—¶é—´æˆ³ï¼ŒåªåŒæ­¥å˜æ›´å†…å®¹
- ğŸ“ **é™„ä»¶ä¸‹è½½** - è‡ªåŠ¨ä¸‹è½½é¡µé¢é™„ä»¶ï¼Œä¿æŒæ–‡ä»¶å…³è”
- ğŸ”„ **å¢é‡æ›´æ–°** - è®°å½•åŒæ­¥çŠ¶æ€ï¼Œé¿å…é‡å¤ä¸‹è½½æœªå˜æ›´é¡µé¢
- ğŸ·ï¸ **å…ƒæ•°æ®ä¿ç•™** - åœ¨ YAML Frontmatter ä¸­ä¿å­˜ Confluence é¡µé¢ IDã€ç‰ˆæœ¬å·ç­‰ä¿¡æ¯
- ğŸ¨ **å¯Œåª’ä½“è½¬æ¢** - æ”¯æŒä»£ç å—ã€å›¾ç‰‡ã€Jira é“¾æ¥ç­‰ Confluence å®è½¬æ¢ä¸º Markdown

## å®‰è£…

### ä» Obsidian ç¤¾åŒºæ’ä»¶å¸‚åœº

1. æ‰“å¼€ Obsidian â†’ è®¾ç½® â†’ ç¬¬ä¸‰æ–¹æ’ä»¶
2. å…³é—­å®‰å…¨æ¨¡å¼
3. ç‚¹å‡»"æµè§ˆ"æœç´¢ "Confluence Sync"
4. ç‚¹å‡»å®‰è£…å¹¶å¯ç”¨

### æ‰‹åŠ¨å®‰è£…

1. ä¸‹è½½æœ€æ–°ç‰ˆæœ¬çš„ `main.js` å’Œ `manifest.json`
2. å¤åˆ¶åˆ°ä½ çš„ Vault ç›®å½• `.obsidian/plugins/confluence-sync/`
3. é‡å¯ Obsidian å¹¶åœ¨è®¾ç½®ä¸­å¯ç”¨æ’ä»¶

## ä½¿ç”¨æ–¹æ³•

### 1. é…ç½®è¿æ¥ä¿¡æ¯

æ‰“å¼€è®¾ç½®é¢æ¿ï¼Œå¡«å†™ä»¥ä¸‹ä¿¡æ¯ï¼š

| é…ç½®é¡¹ | è¯´æ˜ | ç¤ºä¾‹ |
|--------|------|------|
| Confluence åœ°å€ | æœåŠ¡å™¨åŸºç¡€ URL | `https://confluence.company.com` |
| ç”¨æˆ·å | ç™»å½•ç”¨æˆ·å | `your-username` |
| å¯†ç /API Token | å¯†ç æˆ–ä¸ªäººè®¿é—®ä»¤ç‰Œ | `your-password` |
| åŒæ­¥æ–‡ä»¶å¤¹ | Obsidian ä¸­çš„ç›®æ ‡æ–‡ä»¶å¤¹ | `ConfluenceSync` |
| æ ¹é¡µé¢ ID | è¦åŒæ­¥çš„é¡µé¢ IDï¼ˆæ”¯æŒå¤šä¸ªï¼‰ | `123456, 789012` |

### 2. æµ‹è¯•è¿æ¥

ç‚¹å‡»"æµ‹è¯•è¿æ¥"æŒ‰é’®éªŒè¯é…ç½®æ˜¯å¦æ­£ç¡®ã€‚

### 3. æ‰§è¡ŒåŒæ­¥

- **æ‰‹åŠ¨åŒæ­¥**: ç‚¹å‡»"å¼€å§‹åŒæ­¥"æŒ‰é’®æˆ–å‘½ä»¤é¢æ¿ä¸­çš„ "Confluence Sync: ä» Confluence åŒæ­¥"
- **å¼ºåˆ¶å…¨é‡åŒæ­¥**: ä½¿ç”¨å‘½ä»¤ "Confluence Sync: å¼ºåˆ¶å…¨é‡åŒæ­¥" å¿½ç•¥ç¼“å­˜é‡æ–°ä¸‹è½½æ‰€æœ‰å†…å®¹

### 4. å¢é‡æ›´æ–°

æ’ä»¶ä¼šè‡ªåŠ¨è®°å½•ä¸Šæ¬¡åŒæ­¥æ—¶é—´ï¼Œä¸‹æ¬¡åŒæ­¥æ—¶åªè·å–å˜æ›´çš„é¡µé¢ã€‚

## ç›®å½•ç»“æ„

åŒæ­¥åçš„ç›®å½•ç»“æ„ä¿æŒä¸ Confluence ä¸€è‡´ï¼š

```
ConfluenceSync/
â”œâ”€â”€ çˆ¶é¡µé¢A/
â”‚   â”œâ”€â”€ çˆ¶é¡µé¢A.md
â”‚   â””â”€â”€ å­é¡µé¢B.md
â””â”€â”€ çˆ¶é¡µé¢C/
    â”œâ”€â”€ çˆ¶é¡µé¢C.md
    â””â”€â”€ Attachments/
        â””â”€â”€ å›¾ç‰‡1.png
```

- æ¯ä¸ªé¡µé¢ç”Ÿæˆç‹¬ç«‹çš„åŒåæ–‡ä»¶å¤¹
- å­é¡µé¢ç›´æ¥æ”¾åœ¨çˆ¶é¡µé¢ç›®å½•ä¸‹
- é™„ä»¶ç»Ÿä¸€å­˜æ”¾åœ¨ `Attachments/` ç›®å½•

## æ”¯æŒçš„ Confluence å®

| Confluence å® | Markdown è¾“å‡º |
|--------------|---------------|
| ä»£ç å— | å›´æ å¼ä»£ç å— ```language\ncode\n``` |
| å›¾ç‰‡ | Obsidian åŒé“¾ `![[filename.png]]` |
| Jira é“¾æ¥ | å¤–éƒ¨é“¾æ¥ `[KEY](https://jira...)` |
| ä¿¡æ¯é¢æ¿ | å¼•ç”¨å— `> **INFO** ...` |
| åŒé“¾ | å†…éƒ¨é“¾æ¥ `[[é¡µé¢æ ‡é¢˜]]` |

## å‘½ä»¤åˆ—è¡¨

æ‰“å¼€å‘½ä»¤é¢æ¿ï¼ˆCtrl/Cmd + Pï¼‰æœç´¢ "Confluence"ï¼š

- `Confluence Sync: ä» Confluence åŒæ­¥` - æ‰§è¡Œå¢é‡åŒæ­¥
- `Confluence Sync: å¼ºåˆ¶å…¨é‡åŒæ­¥` - æ¸…é™¤ç¼“å­˜åå…¨é‡åŒæ­¥
- `Confluence Sync: æ˜¾ç¤ºåŒæ­¥ç»Ÿè®¡` - æŸ¥çœ‹åŒæ­¥çŠ¶æ€

## é…ç½®è¯´æ˜

### æ ¹é¡µé¢ ID æ ¼å¼

æ”¯æŒå¤šç§åˆ†éš”ç¬¦ï¼š

```
123456
123456, 789012
123456
789012
123456,789012,345678
```

### å¢é‡åŒæ­¥åŸç†

æ’ä»¶åœ¨ `data.json` ä¸­è®°å½•ï¼š
- æ¯ä¸ªé¡µé¢çš„ Confluence ç‰ˆæœ¬å·
- ä¸Šæ¬¡å…¨å±€åŒæ­¥æ—¶é—´æˆ³
- é¡µé¢æœ¬åœ°è·¯å¾„æ˜ å°„

åŒæ­¥æ—¶é€šè¿‡ CQL æŸ¥è¯¢ `lastModified >= "timestamp"` è·å–å˜æ›´å†…å®¹ã€‚

## æŠ€æœ¯å®ç°

- **API è¯·æ±‚**: ä½¿ç”¨ Obsidian `requestUrl` ç»•è¿‡ CORS
- **è®¤è¯æ–¹å¼**: Basic Auth (Base64)
- **HTML è½¬æ¢**: Turndown + è‡ªå®šä¹‰è§„åˆ™å¤„ç† Confluence Storage Format
- **è·¯å¾„è®¡ç®—**: åŸºäº ancestors æ•°ç»„æ™ºèƒ½æ„å»ºç›®å½•æ ‘

## æ›´æ–°æ—¥å¿—

æŸ¥çœ‹ [CHANGELOG.md](./CHANGELOG.md) è·å–ç‰ˆæœ¬å†å²ã€‚

## å¼€å‘

```bash
# å…‹éš†ä»“åº“
git clone https://github.com/Inna0915/obsidian-confluence-flow.git
cd obsidian-confluence-flow

# å®‰è£…ä¾èµ–
npm install

# å¼€å‘æ¨¡å¼ï¼ˆç›‘å¬æ–‡ä»¶å˜åŒ–ï¼‰
npm run dev

# æ„å»ºç”Ÿäº§ç‰ˆæœ¬
npm run build
```

## è®¸å¯è¯

MIT License

## æ”¯æŒ

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·åœ¨ [GitHub Issues](https://github.com/Inna0915/obsidian-confluence-flow/issues) æäº¤åé¦ˆã€‚
